import soundProducer.*
import wollok.game.*
import tablero.*
import direcciones.*
import personajes.*
import ataques.*
import jugadores.*

describe "configuracionBoard" {
	test "ubicacion esta en el board" {
		assert.that(configuracionBoard.estaEnElBoard(game.at(configuracionBoard.anchoBoard() - 1, configuracionBoard.altoBoard() - 2)))
	}
	test "ubicacion no esta en el board" {
		assert.notThat(configuracionBoard.estaEnElBoard(game.at(configuracionBoard.anchoBoard() - 1, configuracionBoard.altoBoard() - 1)))
	}
}

// testea solo izquierda
describe "objetos direcciones"{
	var posicion = game.at(1,2)
	var posicionSiguiente = game.at(0,2)
	var posicionAlBorde = game.at(2, configuracionBoard.altoBoard() - 1)
	test "devuelve direccion siguiente si no se pasa del board"{
		assert.equals(izquierda.proximaPosicion(posicion), posicionSiguiente)
	}
	test "devuelve direccion actual si se pasa del board"{
		assert.equals(arriba.proximaPosicion(posicionAlBorde), posicionAlBorde)
	}
}

describe "Personajes" {
	const soldadoNazi = new Personaje(rangoMaximoMovimiento = 2, position = game.at(0,8), image = "soldadoNazi.png", vida = 100, jugador = new Jugador(personajes = [soldadoNazi]), ataques = [new GomeraDePiedras()])
	const pepita = new Personaje(rangoMaximoMovimiento = 4, image = "pepita.png", position = game.at(0, 9), vida = 150, jugador = new Jugador(personajes = [pepita]))
	const healer = new Personaje(rangoMaximoMovimiento = 5, image = "healer.png", position = game.at(0, 10), vida = 50, jugador = new Jugador(personajes = [healer]), ataques = [new GomeraCuradora()])
	
	method initialize() {
		game.addVisual(pepita)
		game.addVisual(soldadoNazi)
		game.addVisual(healer)
		game.addVisual(cursor)
	} 
	
	only test "Personaje que puede recibir daño de otro personaje" {
		cursor.position(game.at(0,9))
		soldadoNazi.ataque(1).atacante(soldadoNazi)
		soldadoNazi.ataque(1).realizarEfectoAtaque(game.at(0,9)) // donde está pepita
		assert.equals(120, pepita.vida())
	}
	
	test "Personaje que se muere al descontar todos sus puntos de vida" {
		pepita.recibirDanio(150)
		assert.equals(0, pepita.vida())
		assert.notThat(game.hasVisual(pepita))
		assert.notThat(pepita.jugador().esDeJugador(pepita))
	}
}

/*describe "Al matar un personaje, se lo elimina del oponente"{
	
}
*/

